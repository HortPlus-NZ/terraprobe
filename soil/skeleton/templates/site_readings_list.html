{% load static %}
{% block content %}

{% if readings %}

<table class="table table-sm table-striped table-bordered text-nowrap" id="reading-table">
    <thead>
        <tr>
            <th>Type</th>
            <th>Date</th>
            <th>Depth 1</th>
            <th>Depth 2</th>
            <th>Depth 3</th>
            <th>Depth 4</th>
            <th>Depth 5</th>
            <th>Depth 6</th>
            <th>Depth 7</th>
            <th>Depth 8</th>
            <th>Depth 9</th>
            <th>Depth 10</th>
            <th>RZ1</th>
            <th>RZ2</th>
            <th>RZ3</th>
            <th>Deficit</th>
            <th>Prb DWU</th>
            <th>Est DWU</th>
            <th>Rain</th>
            <th>Meter</th>
            <th>Irri (L)</th>
            <th>Irri (mm)</th>
            <th>Effective Rain1</th>
            <th>Effective Rainfall</th>
            <th>efflrr1</th>
            <th>efflrr2</th>
            <th>Effective Irridation</th>
        </tr>
    </thead>
    <tbody>
        {% for reading in readings %}
        <tr>
            <td>{{ reading.type }}</td>
            <td>{{ reading.date }}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw1_perc|floatformat }}
                {% else %}
                {{ reading.vsw1|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw2_perc|floatformat }}
                {% else %}
                {{ reading.vsw2|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw3_perc|floatformat }}
                {% else %}
                {{ reading.vsw3|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw4_perc|floatformat }}
                {% else %}
                {{ reading.vsw4|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw5_perc|floatformat }}
                {% else %}
                {{ reading.vsw5|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw6_perc|floatformat }}
                {% else %}
                {{ reading.vsw6|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw7_perc|floatformat }}
                {% else %}
                {{ reading.vsw7|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw8_perc|floatformat }}
                {% else %}
                {{ reading.vsw8|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw9_perc|floatformat }}
                {% else %}
                {{ reading.vsw9|floatformat }}
                {% endif %}</td>
            <td>{% if reading.type == 'Probe' %}
                {{ reading.vsw10_perc|floatformat }}
                {% else %}
                {{ reading.vsw10|floatformat }}
                {% endif %}</td>
            <td>{{ reading.rz1|floatformat }}</td>
            <td>{{ reading.rz2|floatformat }}</td>
            <td>{{ reading.rz3|floatformat }}</td>
            <td>{{ reading.deficit|floatformat }}</td>
            <td>{{ reading.probe_dwu|floatformat }}</td>
            <td>{{ reading.estimated_dwu|floatformat }}</td>
            <td>{{ reading.rain|floatformat }}</td>
            <td>{{ reading.meter|floatformat }}</td>
            <td>{{ reading.irrigation_litres|floatformat }}</td>
            <td>{{ reading.irrigation_mms|floatformat }}</td>
            <td>{{ reading.effective_rain_1|floatformat }}</td>
            <td>{{ reading.effective_rainfall|floatformat }}</td>
            <td>{{ reading.efflrr1|floatformat }}</td>
            <td>{{ reading.efflrr2|floatformat }}</td>
            <td>{{ reading.effective_irrigation|floatformat }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="card-footer">
    <div class="row">
       <div class="col-sm-4">
           <b>Season to date totals:</b>
       </div>
       <div class="col-sm-4">
           Irrigation: {{ irrigation.irrigation_litres__sum }}
       </div>
       <div class="col-sm-4">
           Rainfall: {{ rainfall.rain__sum }}
       </div>
   </div>
</div>


   <form method="post" id="reading-recommendations" data-recommendations-url="{% url 'ajax_reading_recommendations' %}" novalidate>
       {% csrf_token %}
       <h3>Make Recommendation</h3>
       <label>Hours:</label>
       <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Mon">
            <input type="text" class="form-control" placeholder="Tue">
            <input type="text" class="form-control" placeholder="Wed">
            <input type="text" class="form-control" placeholder="Thu">
            <input type="text" class="form-control" placeholder="Fri">
            <input type="text" class="form-control" placeholder="Sat">
            <input type="text" class="form-control" placeholder="Sun">
        </div>
        <div class="form-group">
            <label for="recommendation">Recommendation:</label>
            <textarea class="form-control" rows="5" id="recommendation">{{ comment }}</textarea>
        </div>
        <button type="button" class="btn bg-green" id="make-recommendation">Make Recommendation</button>
    </form>
{% else %}
    <p>No readings</p>
{% endif %}

<iframe id="widget-iframe" width="300px" height="195px"
 src="https://services.metservice.com/weather-widget/widget?params=blue|medium|portrait|days-3|classic&loc=hastings&type=urban" allowtransparency="true" style="border:none" />

<script>
$("#make-recommendation").click(function() {
    var url = $("#reading-recommendations").attr('data-recommendations-url');
});
</script>
<script>
    $(document).ready(function() {
    $('#reading-table').DataTable({
        "paging": false,
        "scrollX": true,
        "scrollY": "500px",
        scrollCollapse: true,
        "searching": false,
        //fixedColumns: true
    });
} );
</script>

{% endblock content %}
